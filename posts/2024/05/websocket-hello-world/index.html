<!DOCTYPE html>
<html lang="en">

<head>
  <title>
  websocket - Hello World · Techiedeepdive
</title>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="color-scheme" content="light dark">




<meta name="description" content="
  Introduction
  
    
    Link to heading
  

websocket is a cool protocol used for bi-directional communication like notifications or chat applications. From wiki, it says

WebSocket is a computer communications protocol, providing a simultaneous two-way communication channel over a single Transmission Control Protocol (TCP) connection.

WebSocket is distinct from HTTP used to serve most webpages. Although they are different, RFC 6455 states that WebSocket &ldquo;is designed to work over HTTP ports 443 and 80 as well as to support HTTP proxies and intermediaries&rdquo;, thus making it compatible with HTTP. To achieve compatibility, the WebSocket handshake uses the HTTP Upgrade header[3] to change from the HTTP protocol to the WebSocket protocol.">
<meta name="keywords" content="homepage, blog">



  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="/">
  <meta name="twitter:title" content="websocket - Hello World">
  <meta name="twitter:description" content="Introduction Link to heading websocket is a cool protocol used for bi-directional communication like notifications or chat applications. From wiki, it says
WebSocket is a computer communications protocol, providing a simultaneous two-way communication channel over a single Transmission Control Protocol (TCP) connection.
WebSocket is distinct from HTTP used to serve most webpages. Although they are different, RFC 6455 states that WebSocket “is designed to work over HTTP ports 443 and 80 as well as to support HTTP proxies and intermediaries”, thus making it compatible with HTTP. To achieve compatibility, the WebSocket handshake uses the HTTP Upgrade header[3] to change from the HTTP protocol to the WebSocket protocol.">

<meta property="og:url" content="/posts/2024/05/websocket-hello-world/">
  <meta property="og:site_name" content="Techiedeepdive">
  <meta property="og:title" content="websocket - Hello World">
  <meta property="og:description" content="Introduction Link to heading websocket is a cool protocol used for bi-directional communication like notifications or chat applications. From wiki, it says
WebSocket is a computer communications protocol, providing a simultaneous two-way communication channel over a single Transmission Control Protocol (TCP) connection.
WebSocket is distinct from HTTP used to serve most webpages. Although they are different, RFC 6455 states that WebSocket “is designed to work over HTTP ports 443 and 80 as well as to support HTTP proxies and intermediaries”, thus making it compatible with HTTP. To achieve compatibility, the WebSocket handshake uses the HTTP Upgrade header[3] to change from the HTTP protocol to the WebSocket protocol.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-05-23T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-05-23T00:00:00+00:00">
    <meta property="article:tag" content="Web">
    <meta property="og:image" content="/">




<link rel="canonical" href="/posts/2024/05/websocket-hello-world/">


<link rel="preload" href="/fonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin>


  
  
  <link rel="stylesheet" href="/css/coder.min.aa5ef26fa979d6793724ae2dbd71efa94fd16cb1c5c7db3b6651f21f9892a5fd.css" integrity="sha256-ql7yb6l51nk3JK4tvXHvqU/RbLHFx9s7ZlHyH5iSpf0=" crossorigin="anonymous" media="screen" />






  
    
    
    <link rel="stylesheet" href="/css/coder-dark.min.a00e6364bacbc8266ad1cc81230774a1397198f8cfb7bcba29b7d6fcb54ce57f.css" integrity="sha256-oA5jZLrLyCZq0cyBIwd0oTlxmPjPt7y6KbfW/LVM5X8=" crossorigin="anonymous" media="screen" />
  



 




<link rel="icon" type="image/svg+xml" href="/images/favicon.svg" sizes="any">
<link rel="icon" type="image/png" href="/images/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/images/favicon-16x16.png" sizes="16x16">

<link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#5bbad5">









</head>






<body class="preload-transitions colorscheme-auto">
  
<div class="float-container">
    <a id="dark-mode-toggle" class="colorscheme-toggle">
        <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
    </a>
</div>


  <main class="wrapper">
    <nav class="navigation">
  <section class="container">
    
    <a class="navigation-title" href="/">
      Techiedeepdive
    </a>
    
    
      <input type="checkbox" id="menu-toggle" />
      <label class="menu-button float-right" for="menu-toggle">
        <i class="fa-solid fa-bars fa-fw" aria-hidden="true"></i>
      </label>
      <ul class="navigation-list">
        
          
            <li class="navigation-item">
              <a class="navigation-link " href="/posts">Blog</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/reading-list/">Reading list</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/tags/">Tags</a>
            </li>
          
        
        
      </ul>
    
  </section>
</nav>


    <div class="content">
      
  <section class="container post">
    <article>
      <header>
        <div class="post-title">
          <h1 class="title">
            <a class="title-link" href="/posts/2024/05/websocket-hello-world/">
              websocket - Hello World
            </a>
          </h1>
        </div>
        <div class="post-meta">
          <div class="date">
            <span class="posted-on">
              <i class="fa-solid fa-calendar" aria-hidden="true"></i>
              <time datetime="2024-05-23T00:00:00Z">
                May 23, 2024
              </time>
            </span>
            <span class="reading-time">
              <i class="fa-solid fa-clock" aria-hidden="true"></i>
              2-minute read
            </span>
          </div>
          
          
          <div class="tags">
  <i class="fa-solid fa-tag" aria-hidden="true"></i>
    <span class="tag">
      <a href="/tags/web/">Web</a>
    </span></div>

        </div>
      </header>

      <div class="post-content">
        
        <h1 id="introduction">
  Introduction
  <a class="heading-link" href="#introduction">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h1>
<p>websocket is a cool protocol used for bi-directional communication like notifications or chat applications. From wiki, it says</p>
<blockquote>
<p>WebSocket is a computer communications protocol, providing a simultaneous two-way communication channel over a single Transmission Control Protocol (TCP) connection.</p></blockquote>
<blockquote>
<p>WebSocket is distinct from HTTP used to serve most webpages. Although they are different, RFC 6455 states that WebSocket &ldquo;is designed to work over HTTP ports 443 and 80 as well as to support HTTP proxies and intermediaries&rdquo;, thus making it compatible with HTTP. To achieve compatibility, the WebSocket handshake uses the HTTP Upgrade header[3] to change from the HTTP protocol to the WebSocket protocol.</p></blockquote>
<h1 id="client">
  Client
  <a class="heading-link" href="#client">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h1>
<p>for the client(ie browser), socket is created with <code>WebSocket</code> and there where it&rsquo;s connected.</p>
<ul>
<li>call socket.send() to send something to server.</li>
<li><code>onmessage</code> attribute is callback for messages sent from the server.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span><span style="color:#8b949e;font-weight:bold;font-style:italic">&lt;!DOCTYPE html&gt;</span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#7ee787">html</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#7ee787">head</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#7ee787">title</span>&gt;Chat&lt;/<span style="color:#7ee787">title</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;/<span style="color:#7ee787">head</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#7ee787">body</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#7ee787">h1</span>&gt;WebSocket with FastAPI&lt;/<span style="color:#7ee787">h1</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#7ee787">form</span> action<span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">&#34;&#34;</span> onsubmit<span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">&#34;sendMessage(event)&#34;</span>&gt;
</span></span><span style="display:flex;"><span>      &lt;<span style="color:#7ee787">input</span> type<span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">&#34;text&#34;</span> id<span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">&#34;messageText&#34;</span> autocomplete<span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">&#34;off&#34;</span> /&gt;
</span></span><span style="display:flex;"><span>      &lt;<span style="color:#7ee787">button</span>&gt;Send&lt;/<span style="color:#7ee787">button</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#7ee787">form</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#7ee787">ul</span> id<span style="color:#ff7b72;font-weight:bold">=</span><span style="color:#a5d6ff">&#34;messages&#34;</span>&gt;&lt;/<span style="color:#7ee787">ul</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#7ee787">script</span>&gt;
</span></span><span style="display:flex;"><span>      <span style="color:#ff7b72">var</span> ws <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#ff7b72">new</span> WebSocket(<span style="color:#a5d6ff">`ws://localhost:8000/communicate`</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      console.log(<span style="color:#a5d6ff">&#34;Connected&#34;</span>);
</span></span><span style="display:flex;"><span>      ws.onmessage <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#ff7b72">function</span> (event) {
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">var</span> messages <span style="color:#ff7b72;font-weight:bold">=</span> document.getElementById(<span style="color:#a5d6ff">&#34;messages&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">var</span> message <span style="color:#ff7b72;font-weight:bold">=</span> document.createElement(<span style="color:#a5d6ff">&#34;li&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">var</span> content <span style="color:#ff7b72;font-weight:bold">=</span> document.createTextNode(event.data);
</span></span><span style="display:flex;"><span>        message.appendChild(content);
</span></span><span style="display:flex;"><span>        messages.appendChild(message);
</span></span><span style="display:flex;"><span>      };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      console.log(<span style="color:#a5d6ff">&#34;Send Mesage&#34;</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#ff7b72">function</span> sendMessage(event) {
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">var</span> input <span style="color:#ff7b72;font-weight:bold">=</span> document.getElementById(<span style="color:#a5d6ff">&#34;messageText&#34;</span>);
</span></span><span style="display:flex;"><span>        ws.send(input.value);
</span></span><span style="display:flex;"><span>        input.value <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#a5d6ff">&#34;&#34;</span>;
</span></span><span style="display:flex;"><span>        event.preventDefault();
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#7ee787">script</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;/<span style="color:#7ee787">body</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#7ee787">html</span>&gt;
</span></span></code></pre></div><h1 id="server">
  Server
  <a class="heading-link" href="#server">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h1>
<p>For the server, this is example using fastapi <code>WebSocket</code> interface. There is utility connection manager to keep track of connections. <code>receive_text</code> and <code>send_text</code> are called to get messages from and send messages to client connected to the socket.</p>
<div class="highlight"><pre tabindex="0" style="color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ff7b72">from</span> <span style="color:#ff7b72">fastapi</span> <span style="color:#ff7b72">import</span> FastAPI, WebSocket, WebSocketDisconnect
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">class</span> <span style="color:#f0883e;font-weight:bold">ConnectionManager</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">def</span> <span style="color:#d2a8ff;font-weight:bold">__init__</span>(self):
</span></span><span style="display:flex;"><span>        self<span style="color:#ff7b72;font-weight:bold">.</span>active_connections <span style="color:#ff7b72;font-weight:bold">=</span> []
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">async</span> <span style="color:#ff7b72">def</span> <span style="color:#d2a8ff;font-weight:bold">connect</span>(self, websocket: WebSocket):
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">await</span> websocket<span style="color:#ff7b72;font-weight:bold">.</span>accept()
</span></span><span style="display:flex;"><span>        self<span style="color:#ff7b72;font-weight:bold">.</span>active_connections<span style="color:#ff7b72;font-weight:bold">.</span>append(websocket)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">async</span> <span style="color:#ff7b72">def</span> <span style="color:#d2a8ff;font-weight:bold">send_personal_message</span>(self, message: str, websocket: WebSocket):
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">await</span> websocket<span style="color:#ff7b72;font-weight:bold">.</span>send_text(message)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">def</span> <span style="color:#d2a8ff;font-weight:bold">disconnect</span>(self, websocket: WebSocket):
</span></span><span style="display:flex;"><span>        self<span style="color:#ff7b72;font-weight:bold">.</span>active_connections<span style="color:#ff7b72;font-weight:bold">.</span>remove(websocket)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>app <span style="color:#ff7b72;font-weight:bold">=</span> FastAPI()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>manager <span style="color:#ff7b72;font-weight:bold">=</span> ConnectionManager()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#d2a8ff;font-weight:bold">@app.websocket</span>(<span style="color:#a5d6ff">&#34;/communicate&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#ff7b72">async</span> <span style="color:#ff7b72">def</span> <span style="color:#d2a8ff;font-weight:bold">websocket_endpoint</span>(websocket: WebSocket):
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">await</span> manager<span style="color:#ff7b72;font-weight:bold">.</span>connect(websocket)
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">try</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">while</span> <span style="color:#79c0ff">True</span>:
</span></span><span style="display:flex;"><span>            data <span style="color:#ff7b72;font-weight:bold">=</span> <span style="color:#ff7b72">await</span> websocket<span style="color:#ff7b72;font-weight:bold">.</span>receive_text()
</span></span><span style="display:flex;"><span>            <span style="color:#ff7b72">await</span> manager<span style="color:#ff7b72;font-weight:bold">.</span>send_personal_message(<span style="color:#79c0ff">f</span><span style="color:#a5d6ff">&#34;Received:</span><span style="color:#a5d6ff">{</span>data<span style="color:#a5d6ff">}</span><span style="color:#a5d6ff">&#34;</span>, websocket)
</span></span><span style="display:flex;"><span>    <span style="color:#ff7b72">except</span> WebSocketDisconnect:
</span></span><span style="display:flex;"><span>        manager<span style="color:#ff7b72;font-weight:bold">.</span>disconnect(websocket)
</span></span><span style="display:flex;"><span>        <span style="color:#ff7b72">await</span> manager<span style="color:#ff7b72;font-weight:bold">.</span>send_personal_message(<span style="color:#a5d6ff">&#34;Bye!!!&#34;</span>, websocket)
</span></span></code></pre></div>
      </div>


      <footer>
        


        
        
        
        
        
        
        
      </footer>
    </article>

    
  </section>

    </div>

    <footer class="footer">
  <section class="container">
    ©
    
    2025
    
    ·
    
      Licensed under <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA-4.0</a>
    ·
    
    Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> & <a href="https://github.com/luizdepra/hugo-coder/" target="_blank" rel="noopener">Coder</a>.
    
  </section>
</footer>

  </main>

  

  
  
  <script src="/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js" integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script>
  

  

  


  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
</body>

</html>
