<!DOCTYPE html>
<html lang="en">

<head>
  <title>
  UVM Internals - objections · Techiedeepdive
</title>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="color-scheme" content="light dark">




<meta name="description" content="This post is a deep dive into UVM objections implementation. Objections are UVM mechanism to control test shutdown(or stopping shutdown really).. It basically keeps things running until all important things stops running(ie objections are dropped).
raise_objection and drop_objection are used at the start and end of run_phase as follows
55 class test extends test_base; 56 `uvm_component_utils(test) 57 61 62 task run_phase(uvm_phase phase); 65 66 phase.raise_objection(this); ... ... 87 phase.drop_objection(this); 88 endtask RANT: Before I started this, It seemed simple enough but it turned out to be more complicated than I thought.">
<meta name="keywords" content="">

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content=""/>

<meta name="twitter:title" content="UVM Internals - objections"/>
<meta name="twitter:description" content="This post is a deep dive into UVM objections implementation. Objections are UVM mechanism to control test shutdown(or stopping shutdown really).. It basically keeps things running until all important things stops running(ie objections are dropped).
raise_objection and drop_objection are used at the start and end of run_phase as follows
55 class test extends test_base; 56 `uvm_component_utils(test) 57 61 62 task run_phase(uvm_phase phase); 65 66 phase.raise_objection(this); ... ... 87 phase.drop_objection(this); 88 endtask RANT: Before I started this, It seemed simple enough but it turned out to be more complicated than I thought."/>

<meta property="og:title" content="UVM Internals - objections" />
<meta property="og:description" content="This post is a deep dive into UVM objections implementation. Objections are UVM mechanism to control test shutdown(or stopping shutdown really).. It basically keeps things running until all important things stops running(ie objections are dropped).
raise_objection and drop_objection are used at the start and end of run_phase as follows
55 class test extends test_base; 56 `uvm_component_utils(test) 57 61 62 task run_phase(uvm_phase phase); 65 66 phase.raise_objection(this); ... ... 87 phase.drop_objection(this); 88 endtask RANT: Before I started this, It seemed simple enough but it turned out to be more complicated than I thought." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/2022/09/uvm-internals-objections/" /><meta property="og:image" content=""/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-09-24T00:00:00+00:00" />
<meta property="article:modified_time" content="2022-09-24T00:00:00+00:00" /><meta property="og:site_name" content="Techiedeepdive" />
<meta property="og:see_also" content="/posts/2023/09/uvm-internals-set_config_int-and-set_config_string/" /><meta property="og:see_also" content="/posts/2023/02/uvm-internals-deepdive-into-uvm_reg_predictor/" /><meta property="og:see_also" content="/posts/2023/02/uvm-internals-deepdive-into-uvm_reg_bit_bash_seq/" /><meta property="og:see_also" content="/posts/2023/02/uvm-internals-what-happens-when-you-call-set_auto_predict/" /><meta property="og:see_also" content="/posts/2023/01/uvm-internals-uvm_pool/" /><meta property="og:see_also" content="/posts/2023/01/uvm-internals-uvm_barrier/" />





<link rel="canonical" href="/posts/2022/09/uvm-internals-objections/">


<link rel="preload" href="/fonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin>


  
  
  <link rel="stylesheet" href="/css/coder.min.577e3c5ead537873430da16f0964b754a120fd87c4e2203a00686e7c75b51378.css" integrity="sha256-V348Xq1TeHNDDaFvCWS3VKEg/YfE4iA6AGhufHW1E3g=" crossorigin="anonymous" media="screen" />






  
    
    
    <link rel="stylesheet" href="/css/coder-dark.min.a00e6364bacbc8266ad1cc81230774a1397198f8cfb7bcba29b7d6fcb54ce57f.css" integrity="sha256-oA5jZLrLyCZq0cyBIwd0oTlxmPjPt7y6KbfW/LVM5X8=" crossorigin="anonymous" media="screen" />
  



 




<link rel="icon" type="image/svg+xml" href="/images/favicon.svg" sizes="any">
<link rel="icon" type="image/png" href="/images/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/images/favicon-16x16.png" sizes="16x16">

<link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#5bbad5">









</head>






<body class="preload-transitions colorscheme-auto">
  
<div class="float-container">
    <a id="dark-mode-toggle" class="colorscheme-toggle">
        <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
    </a>
</div>


  <main class="wrapper">
    <nav class="navigation">
  <section class="container">
    
    <a class="navigation-title" href="">
      Techiedeepdive
    </a>
    
    
      <input type="checkbox" id="menu-toggle" />
      <label class="menu-button float-right" for="menu-toggle">
        <i class="fa-solid fa-bars fa-fw" aria-hidden="true"></i>
      </label>
      <ul class="navigation-list">
        
          
            <li class="navigation-item">
              <a class="navigation-link " href="/posts">Blog</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/reading-list/">Reading list</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/tags/">Tags</a>
            </li>
          
        
        
      </ul>
    
  </section>
</nav>


    <div class="content">
      
  <section class="container post">
    <article>
      <header>
        <div class="post-title">
          <h1 class="title">
            <a class="title-link" href="/posts/2022/09/uvm-internals-objections/">
              UVM Internals - objections
            </a>
          </h1>
        </div>
        <div class="post-meta">
          <div class="date">
            <span class="posted-on">
              <i class="fa-solid fa-calendar" aria-hidden="true"></i>
              <time datetime="2022-09-24T00:00:00Z">
                September 24, 2022
              </time>
            </span>
            <span class="reading-time">
              <i class="fa-solid fa-clock" aria-hidden="true"></i>
              4-minute read
            </span>
          </div>
          
          
          <div class="tags">
  <i class="fa-solid fa-tag" aria-hidden="true"></i>
    <span class="tag">
      <a href="/tags/uvm/">UVM</a>
    </span></div>

        </div>
      </header>

      <div class="post-content">
        
        <p>This post is a deep dive into UVM objections implementation. Objections are UVM mechanism to control test shutdown(or stopping shutdown really).. It basically keeps things running until all important things stops running(ie objections are dropped).</p>
<p><code>raise_objection</code> and <code>drop_objection</code> are used at the start and end of run_phase as follows</p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-verilog" data-lang="verilog"><span style="color:#ff0;font-weight:bold">55</span> class test extends test_base;
<span style="color:#ff0;font-weight:bold">56</span>    `uvm_component_utils(test)
<span style="color:#ff0;font-weight:bold">57</span>
<span style="color:#ff0;font-weight:bold">61</span>
<span style="color:#ff0;font-weight:bold">62</span>    <span style="color:#fff;font-weight:bold">task</span> run_phase(uvm_phase phase);
<span style="color:#ff0;font-weight:bold">65</span>
<span style="color:#ff0;font-weight:bold">66</span>       phase.raise_objection(this);
    ...
    ...
<span style="color:#ff0;font-weight:bold">87</span>       phase.drop_objection(this);
<span style="color:#ff0;font-weight:bold">88</span>    <span style="color:#fff;font-weight:bold">endtask</span>
</code></pre></div><p>RANT: Before I started this, It seemed simple enough but it turned out to be more complicated than I thought. Actually, this is my third time trying to write this.</p>
<h1 id="raise_objection-and-drop_objection">
  raise_objection and drop_objection
  <a class="heading-link" href="#raise_objection-and-drop_objection">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h1>
<p><code>raise_objections</code> is called from <code>phase</code>. So,  Jumping to <code>raise_objection</code> defined in <code>uvm_phase.svh</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-verilog" data-lang="verilog"><span style="color:#fff;font-weight:bold">function</span> <span style="color:#fff;font-weight:bold">void</span> uvm_phase::raise_objection (uvm_object obj,
                                                   <span style="color:#fff;font-weight:bold">string</span> description=<span style="color:#0ff;font-weight:bold">&#34;&#34;</span>,
                                                   <span style="color:#fff;font-weight:bold">int</span> count=<span style="color:#ff0;font-weight:bold">1</span>);
  phase_done.raise_objection(obj,description,count);
<span style="color:#fff;font-weight:bold">endfunction</span>

</code></pre></div><p><code>phase_done</code> variable is of type <code>uvm_objection</code></p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-verilog" data-lang="verilog">uvm_objection phase_done; <span style="color:#007f7f">// phase done objection
</span></code></pre></div><p>Jumping to <code>uvm_objection.svh</code>, <code>raise_objection</code> calls <code>m_raise</code></p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-verilog" data-lang="verilog">  virtual <span style="color:#fff;font-weight:bold">function</span> <span style="color:#fff;font-weight:bold">void</span> raise_objection (uvm_object obj=null,
                                         <span style="color:#fff;font-weight:bold">string</span> description=<span style="color:#0ff;font-weight:bold">&#34;&#34;</span>,
                                         <span style="color:#fff;font-weight:bold">int</span> count=<span style="color:#ff0;font-weight:bold">1</span>);
    <span style="color:#fff;font-weight:bold">if</span>(obj == null)
      obj = m_top;
    m_cleared = <span style="color:#ff0;font-weight:bold">0</span>;
    m_top_all_dropped = <span style="color:#ff0;font-weight:bold">0</span>;
    m_raise (obj, obj, description, count);
  <span style="color:#fff;font-weight:bold">endfunction</span>
</code></pre></div><p><code>m_raise</code> does a lot of things but mostly it does the bookkeeping for objections. In the snippet below, it increments the <code>m_total_count</code> and <code>m_source_count</code></p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-verilog" data-lang="verilog"> <span style="color:#ff0;font-weight:bold">398</span>   <span style="color:#fff;font-weight:bold">function</span> <span style="color:#fff;font-weight:bold">void</span> m_raise (uvm_object obj,
 <span style="color:#ff0;font-weight:bold">399</span>                          uvm_object source_obj,
 <span style="color:#ff0;font-weight:bold">400</span>                          <span style="color:#fff;font-weight:bold">string</span> description=<span style="color:#0ff;font-weight:bold">&#34;&#34;</span>,
 <span style="color:#ff0;font-weight:bold">401</span>                          <span style="color:#fff;font-weight:bold">int</span> count=<span style="color:#ff0;font-weight:bold">1</span>);
 <span style="color:#ff0;font-weight:bold">402</span>     <span style="color:#fff;font-weight:bold">int</span> idx;
 <span style="color:#ff0;font-weight:bold">403</span>     uvm_objection_context_object ctxt;
 <span style="color:#ff0;font-weight:bold">404</span> 
 <span style="color:#ff0;font-weight:bold">405</span>     <span style="color:#fff;font-weight:bold">if</span> (m_total_count.exists(obj))
 <span style="color:#ff0;font-weight:bold">406</span>       m_total_count[obj] += count;
 <span style="color:#ff0;font-weight:bold">407</span>     <span style="color:#fff;font-weight:bold">else</span> 
 <span style="color:#ff0;font-weight:bold">408</span>       m_total_count[obj] = count;
 <span style="color:#ff0;font-weight:bold">409</span> 
 <span style="color:#ff0;font-weight:bold">410</span>     <span style="color:#fff;font-weight:bold">if</span> (source_obj==obj) <span style="color:#fff;font-weight:bold">begin</span>
 <span style="color:#ff0;font-weight:bold">411</span>       <span style="color:#fff;font-weight:bold">if</span> (m_source_count.exists(obj))
 <span style="color:#ff0;font-weight:bold">412</span>         m_source_count[obj] += count;
 <span style="color:#ff0;font-weight:bold">413</span>       <span style="color:#fff;font-weight:bold">else</span>
 <span style="color:#ff0;font-weight:bold">414</span>         m_source_count[obj] = count;
 <span style="color:#ff0;font-weight:bold">415</span>     <span style="color:#fff;font-weight:bold">end</span>

</code></pre></div><p>Next, it calls <code>raised</code> which calls <code>comp.raised</code> on that component and triggers <code>m_events</code></p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-verilog" data-lang="verilog">    raised(obj, source_obj, description, count);
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-verilog" data-lang="verilog"> <span style="color:#ff0;font-weight:bold">800</span>   virtual <span style="color:#fff;font-weight:bold">function</span> <span style="color:#fff;font-weight:bold">void</span> raised (uvm_object obj,
 <span style="color:#ff0;font-weight:bold">801</span>                                 uvm_object source_obj,
 <span style="color:#ff0;font-weight:bold">802</span>                                 <span style="color:#fff;font-weight:bold">string</span> description,
 <span style="color:#ff0;font-weight:bold">803</span>                                 <span style="color:#fff;font-weight:bold">int</span> count);
 <span style="color:#ff0;font-weight:bold">804</span>     uvm_component comp;
 <span style="color:#ff0;font-weight:bold">805</span>     <span style="color:#fff;font-weight:bold">if</span> ($cast(comp,obj))
 <span style="color:#ff0;font-weight:bold">806</span>       comp.raised(this, source_obj, description, count);
 <span style="color:#ff0;font-weight:bold">807</span>     <span style="color:#fff;font-weight:bold">if</span> (m_events.exists(obj))
 <span style="color:#ff0;font-weight:bold">808</span>        -&gt;m_events[obj].raised;
 <span style="color:#ff0;font-weight:bold">809</span>   <span style="color:#fff;font-weight:bold">endfunction</span>

</code></pre></div><p>Enough about <code>raise_objection</code>, Let&rsquo;s look at <code>drop_objection</code>, It calls <code>m_drop</code> which backtracks everything <code>m_raise</code> does.</p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-verilog" data-lang="verilog"> <span style="color:#ff0;font-weight:bold">587</span>   <span style="color:#fff;font-weight:bold">function</span> <span style="color:#fff;font-weight:bold">void</span> m_drop (uvm_object obj,
 <span style="color:#ff0;font-weight:bold">588</span>                         uvm_object source_obj,
 <span style="color:#ff0;font-weight:bold">589</span>                         <span style="color:#fff;font-weight:bold">string</span> description=<span style="color:#0ff;font-weight:bold">&#34;&#34;</span>,
 <span style="color:#ff0;font-weight:bold">590</span>                         <span style="color:#fff;font-weight:bold">int</span> count=<span style="color:#ff0;font-weight:bold">1</span>,
 <span style="color:#ff0;font-weight:bold">591</span>                         <span style="color:#fff;font-weight:bold">int</span> in_top_thread=<span style="color:#ff0;font-weight:bold">0</span>);
 <span style="color:#ff0;font-weight:bold">592</span>
 <span style="color:#ff0;font-weight:bold">600</span>
 <span style="color:#ff0;font-weight:bold">601</span>     <span style="color:#fff;font-weight:bold">if</span> (obj == source_obj) <span style="color:#fff;font-weight:bold">begin</span>
 <span style="color:#ff0;font-weight:bold">602</span>       <span style="color:#fff;font-weight:bold">if</span> (!m_source_count.exists(obj) || (count &gt; m_source_count[obj])) <span style="color:#fff;font-weight:bold">begin</span>
 <span style="color:#ff0;font-weight:bold">603</span>         <span style="color:#fff;font-weight:bold">if</span>(m_cleared)
 <span style="color:#ff0;font-weight:bold">604</span>           <span style="color:#fff;font-weight:bold">return</span>;
 <span style="color:#ff0;font-weight:bold">605</span>         uvm_report_fatal(<span style="color:#0ff;font-weight:bold">&#34;OBJTN_ZERO&#34;</span>, {<span style="color:#0ff;font-weight:bold">&#34;Object </span><span style="color:#0ff;font-weight:bold">\&#34;</span><span style="color:#0ff;font-weight:bold">&#34;</span>, obj.get_full_name(),
 <span style="color:#ff0;font-weight:bold">606</span>           <span style="color:#0ff;font-weight:bold">&#34;</span><span style="color:#0ff;font-weight:bold">\&#34;</span><span style="color:#0ff;font-weight:bold"> attempted to drop objection &#39;&#34;</span>,this.get_name(),<span style="color:#0ff;font-weight:bold">&#34;&#39; count below zero&#34;</span>});
 <span style="color:#ff0;font-weight:bold">607</span>         <span style="color:#fff;font-weight:bold">return</span>;
 <span style="color:#ff0;font-weight:bold">608</span>       <span style="color:#fff;font-weight:bold">end</span>
 <span style="color:#ff0;font-weight:bold">609</span>       m_source_count[obj] -= count;
 <span style="color:#ff0;font-weight:bold">610</span>     <span style="color:#fff;font-weight:bold">end</span>
 <span style="color:#ff0;font-weight:bold">611</span>
 <span style="color:#ff0;font-weight:bold">612</span>     m_total_count[obj] -= count;
 <span style="color:#ff0;font-weight:bold">613</span>
</code></pre></div><p>The important part is updating <code>m_scheduled_list</code>. I will circle back to this.</p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-verilog" data-lang="verilog">m_scheduled_list.push_back(ctxt);
</code></pre></div><h1 id="test-termination">
  Test Termination
  <a class="heading-link" href="#test-termination">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h1>
<p>So far, I don&rsquo;t know how the objection stops test termination. Naturally, I look into <code>uvm_phase.svh</code> to understand the phase execution.</p>
<p><code>uvm_phase::execute_phase</code> forks several threads, One of those threads is <code>WAIT_FOR_ALL_DROPPED</code>. basically, it checks <code>m_top_all_dropped</code> and  goes into <code>wait_for</code> waiting for <code>UVM_ALL_DROPPED</code></p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-verilog" data-lang="verilog"><span style="color:#ff0;font-weight:bold">1197</span>                  <span style="color:#fff;font-weight:bold">if</span> (!phase_done.m_top_all_dropped)
<span style="color:#ff0;font-weight:bold">1198</span>                    phase_done.wait_for(UVM_ALL_DROPPED, top);
</code></pre></div><p><code>wait_for</code> is waiting for m_events to get <code>all_dropped</code></p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-verilog" data-lang="verilog"> <span style="color:#ff0;font-weight:bold">880</span>      m_events[obj].waiters++;
 <span style="color:#ff0;font-weight:bold">881</span>      <span style="color:#fff;font-weight:bold">case</span> (objt_event)
 <span style="color:#ff0;font-weight:bold">882</span>        UVM_RAISED:      @(m_events[obj].raised);
 <span style="color:#ff0;font-weight:bold">883</span>        UVM_DROPPED:     @(m_events[obj].dropped);
 <span style="color:#ff0;font-weight:bold">884</span>        UVM_ALL_DROPPED: @(m_events[obj].all_dropped);
 <span style="color:#ff0;font-weight:bold">885</span>      <span style="color:#fff;font-weight:bold">endcase</span>
 <span style="color:#ff0;font-weight:bold">886</span>
</code></pre></div><p><code>all_dropped</code> is the task that sends <code>m_events[obj].all_dropped</code> trigger</p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-verilog" data-lang="verilog"> <span style="color:#ff0;font-weight:bold">829</span>   <span style="color:#007f7f">// Function: all_dropped
</span><span style="color:#007f7f"></span> <span style="color:#ff0;font-weight:bold">830</span>   <span style="color:#007f7f">//
</span><span style="color:#007f7f"></span> <span style="color:#ff0;font-weight:bold">831</span>   <span style="color:#007f7f">// Objection callback that is called when a &lt;drop_objection&gt; has reached ~obj~,
</span><span style="color:#007f7f"></span> <span style="color:#ff0;font-weight:bold">832</span>   <span style="color:#007f7f">// and the total count for ~obj~ goes to zero. This callback is executed
</span><span style="color:#007f7f"></span> <span style="color:#ff0;font-weight:bold">833</span>   <span style="color:#007f7f">// after the drain time associated with ~obj~. The default implementation
</span><span style="color:#007f7f"></span> <span style="color:#ff0;font-weight:bold">834</span>   <span style="color:#007f7f">// calls &lt;uvm_component::all_dropped&gt;.
</span><span style="color:#007f7f"></span>
 <span style="color:#ff0;font-weight:bold">836</span>   virtual <span style="color:#fff;font-weight:bold">task</span> all_dropped (uvm_object obj,
 <span style="color:#ff0;font-weight:bold">837</span>                             uvm_object source_obj,
 <span style="color:#ff0;font-weight:bold">838</span>                             <span style="color:#fff;font-weight:bold">string</span> description,
 <span style="color:#ff0;font-weight:bold">839</span>                             <span style="color:#fff;font-weight:bold">int</span> count);
 <span style="color:#ff0;font-weight:bold">840</span>     uvm_component comp;
 <span style="color:#ff0;font-weight:bold">841</span>     <span style="color:#fff;font-weight:bold">if</span>($cast(comp,obj))
 <span style="color:#ff0;font-weight:bold">842</span>       comp.all_dropped(this, source_obj, description, count);
 <span style="color:#ff0;font-weight:bold">843</span>     <span style="color:#fff;font-weight:bold">if</span> (m_events.exists(obj))
 <span style="color:#ff0;font-weight:bold">844</span>        -&gt;m_events[obj].all_dropped;
 <span style="color:#ff0;font-weight:bold">845</span>     <span style="color:#fff;font-weight:bold">if</span> (obj == m_top)
 <span style="color:#ff0;font-weight:bold">846</span>       m_top_all_dropped = <span style="color:#ff0;font-weight:bold">1</span>;
 <span style="color:#ff0;font-weight:bold">847</span>   <span style="color:#fff;font-weight:bold">endtask</span>
</code></pre></div><p>What calls <code>all_dropped</code>? I will trace from the end here and work my way backward.</p>
<p><code>all_dropped</code> is called from <code>m_forked_drain</code></p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-verilog" data-lang="verilog">all_dropped(obj,source_obj,description, count)
</code></pre></div><p>and <code>m_forked_drain</code> is called from <code>m_execute_scheduled_forks</code></p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-verilog" data-lang="verilog"> <span style="color:#ff0;font-weight:bold">697</span> `endif
 <span style="color:#ff0;font-weight:bold">698</span>                       <span style="color:#007f7f">// Execute the forked drain
</span><span style="color:#007f7f"></span> <span style="color:#ff0;font-weight:bold">699</span>                       objection.m_forked_drain(ctxt.obj, ctxt.source_obj, ctxt.description, ctxt.count, <span style="color:#ff0;font-weight:bold">1</span>);
</code></pre></div><p><code>m_execute_scheduled_forks</code> waits for m_scheduled_list to have something.</p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-verilog" data-lang="verilog"> <span style="color:#ff0;font-weight:bold">662</span>   <span style="color:#007f7f">// background process; when non
</span><span style="color:#007f7f"></span> <span style="color:#ff0;font-weight:bold">663</span>   static <span style="color:#fff;font-weight:bold">task</span> m_execute_scheduled_forks();
 <span style="color:#ff0;font-weight:bold">664</span>     <span style="color:#fff;font-weight:bold">while</span>(<span style="color:#ff0;font-weight:bold">1</span>) <span style="color:#fff;font-weight:bold">begin</span>
 <span style="color:#ff0;font-weight:bold">665</span>       <span style="color:#fff;font-weight:bold">wait</span>(m_scheduled_list.size() != <span style="color:#ff0;font-weight:bold">0</span>);
 <span style="color:#ff0;font-weight:bold">666</span>       <span style="color:#fff;font-weight:bold">if</span>(m_scheduled_list.size() != <span style="color:#ff0;font-weight:bold">0</span>) <span style="color:#fff;font-weight:bold">begin</span>
 <span style="color:#ff0;font-weight:bold">667</span>           uvm_objection_context_object c;
 <span style="color:#ff0;font-weight:bold">668</span>           uvm_objection o;
</code></pre></div><p>Notes that <code>m_execute_scheduled_forks</code> is called from <code>m_init_objections</code> which is called from</p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-verilog" data-lang="verilog"> <span style="color:#ff0;font-weight:bold">764</span>   static <span style="color:#fff;font-weight:bold">function</span> <span style="color:#fff;font-weight:bold">void</span> m_init_objections();
 <span style="color:#ff0;font-weight:bold">765</span>     <span style="color:#fff;font-weight:bold">fork</span>
 <span style="color:#ff0;font-weight:bold">766</span>       uvm_objection::m_execute_scheduled_forks();
 <span style="color:#ff0;font-weight:bold">767</span>     join_none
 <span style="color:#ff0;font-weight:bold">768</span>   <span style="color:#fff;font-weight:bold">endfunction</span>
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-verilog" data-lang="verilog"><span style="color:#ff0;font-weight:bold">319</span> <span style="color:#fff;font-weight:bold">task</span> uvm_root::run_test(<span style="color:#fff;font-weight:bold">string</span> test_name=<span style="color:#0ff;font-weight:bold">&#34;&#34;</span>);
<span style="color:#ff0;font-weight:bold">320</span>
<span style="color:#ff0;font-weight:bold">332</span>   <span style="color:#007f7f">// Set up the process that decouples the thread that drops objections from
</span><span style="color:#007f7f"></span><span style="color:#ff0;font-weight:bold">333</span>   <span style="color:#007f7f">// the process that processes drop/all_dropped objections. Thus, if the
</span><span style="color:#007f7f"></span><span style="color:#ff0;font-weight:bold">334</span>   <span style="color:#007f7f">// original calling thread (the &#34;dropper&#34;) gets killed, it does not affect
</span><span style="color:#007f7f"></span><span style="color:#ff0;font-weight:bold">335</span>   <span style="color:#007f7f">// drain-time and propagation of the drop up the hierarchy.
</span><span style="color:#007f7f"></span><span style="color:#ff0;font-weight:bold">336</span>   <span style="color:#007f7f">// Needs to be done in run_test since it needs to be in an
</span><span style="color:#007f7f"></span><span style="color:#ff0;font-weight:bold">337</span>   <span style="color:#007f7f">// initial block to fork a process.
</span><span style="color:#007f7f"></span><span style="color:#ff0;font-weight:bold">338</span>   uvm_objection::m_init_objections();
</code></pre></div><p>Back to <code>m_drop</code>m m_scheduled_list is updated with <code>ctxt</code> which activates the logic in <code>m_execute_scheduled_forks</code></p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-verilog" data-lang="verilog">m_scheduled_list.push_back(ctxt)
</code></pre></div>
      </div>


      <footer>
        

<section class="see-also">
  
    
    
    
      <h3 id="see-also-in-uvm-internals">
        See also in UVM Internals
        <a class="heading-link" href="#see-also-in-uvm-internals">
          <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
          <span class="sr-only">Link to heading</span>
        </a>
      </h3>
      <nav>
        <ul>
        
        
          
            <li>
              <a href="/posts/2023/09/uvm-internals-set_config_int-and-set_config_string/">UVM Internals - set_config_int and set_config_string</a>
            </li>
          
        
          
            <li>
              <a href="/posts/2023/02/uvm-internals-deepdive-into-uvm_reg_predictor/">UVM Internals - deepdive into uvm_reg_predictor</a>
            </li>
          
        
          
            <li>
              <a href="/posts/2023/02/uvm-internals-deepdive-into-uvm_reg_bit_bash_seq/">UVM Internals - Deepdive into uvm_reg_bit_bash_seq</a>
            </li>
          
        
          
            <li>
              <a href="/posts/2023/02/uvm-internals-what-happens-when-you-call-set_auto_predict/">UVM Internals - What happens when you call set_auto_predict</a>
            </li>
          
        
          
            <li>
              <a href="/posts/2023/01/uvm-internals-uvm_pool/">UVM Internals - uvm_pool</a>
            </li>
          
        
          
            <li>
              <a href="/posts/2023/01/uvm-internals-uvm_barrier/">UVM Internals - uvm_barrier</a>
            </li>
          
        
        </ul>
      </nav>
    
  
</section>


        
        
        
        
        

        
      </footer>
    </article>

    
  </section>

    </div>

    <footer class="footer">
  <section class="container">
    ©
    
    2024
    
    ·
    
      Licensed under <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA-4.0</a>
    ·
    
    Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> & <a href="https://github.com/luizdepra/hugo-coder/" target="_blank" rel="noopener">Coder</a>.
    
  </section>
</footer>

  </main>

  

  
  
  <script src="/js/coder.min.369d90111ae4409b4e51de5efd23a46b92663fcc82dc9a0efde7f70bffc3f949.js" integrity="sha256-Np2QERrkQJtOUd5e/SOka5JmP8yC3JoO/ef3C//D&#43;Uk="></script>
  

  

  


  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
</body>

</html>
