<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="">
<meta name="description" content="NIST defines Root of trust (RoT) as follows
 Roots of trust are highly reliable hardware, firmware, and software components that perform specific, critical security functions. Because roots of trust are inherently trusted, they must be secure by design.
 Basically, It&amp;rsquo;s hardware implementation of security functions like
 key management(generation and storage) cryptographic functions(Block ciphers, Asymmetric key crypto, Hash)  The hardware is designed with security threat model in mind." />
<meta name="keywords" content=", crypto" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="/posts/2023/02/root-of-trust-primer/" />


    <title>
        
            Root of trust primer :: Techiedeepdive 
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="/main.de188b3201233c251f4fd6306dbd2cb41e408fb8846c09781b2925de7df5025c.css">






<meta itemprop="name" content="Root of trust primer">
<meta itemprop="description" content="NIST defines Root of trust (RoT) as follows
 Roots of trust are highly reliable hardware, firmware, and software components that perform specific, critical security functions. Because roots of trust are inherently trusted, they must be secure by design.
 Basically, It&rsquo;s hardware implementation of security functions like
 key management(generation and storage) cryptographic functions(Block ciphers, Asymmetric key crypto, Hash)  The hardware is designed with security threat model in mind."><meta itemprop="datePublished" content="2023-02-17T00:00:00+00:00" />
<meta itemprop="dateModified" content="2023-02-17T00:00:00+00:00" />
<meta itemprop="wordCount" content="643"><meta itemprop="image" content=""/>
<meta itemprop="keywords" content="crypto," />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content=""/>

<meta name="twitter:title" content="Root of trust primer"/>
<meta name="twitter:description" content="NIST defines Root of trust (RoT) as follows
 Roots of trust are highly reliable hardware, firmware, and software components that perform specific, critical security functions. Because roots of trust are inherently trusted, they must be secure by design.
 Basically, It&rsquo;s hardware implementation of security functions like
 key management(generation and storage) cryptographic functions(Block ciphers, Asymmetric key crypto, Hash)  The hardware is designed with security threat model in mind."/>




    <meta property="og:title" content="Root of trust primer" />
<meta property="og:description" content="NIST defines Root of trust (RoT) as follows
 Roots of trust are highly reliable hardware, firmware, and software components that perform specific, critical security functions. Because roots of trust are inherently trusted, they must be secure by design.
 Basically, It&rsquo;s hardware implementation of security functions like
 key management(generation and storage) cryptographic functions(Block ciphers, Asymmetric key crypto, Hash)  The hardware is designed with security threat model in mind." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/2023/02/root-of-trust-primer/" /><meta property="og:image" content=""/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-02-17T00:00:00+00:00" />
<meta property="article:modified_time" content="2023-02-17T00:00:00+00:00" /><meta property="og:site_name" content="Techiedeepdive" />







    <meta property="article:published_time" content="2023-02-17 00:00:00 &#43;0000 UTC" />








    </head>

    
        <body>
    
    
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text">$ cd /home/</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="/about/">About</a></li><li><a href="/posts">Blog</a></li><li><a href="/reading-list/">Reading list</a></li><li><a href="/tags/">Tags</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            
        </span>
    </span>
</header>


            <div class="content">
                
  <main class="post">

    <div class="post-info">
      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock">
          <circle cx="12" cy="12" r="10"></circle>
          <polyline points="12 6 12 12 16 14"></polyline>
        </svg>
        4 minutes

        
      </p>
    </div>

    <article>
      <h1 class="post-title">
        <a href="/posts/2023/02/root-of-trust-primer/">Root of trust primer</a>
      </h1>

      

      

      <div class="post-content">
        <p><a href="https://csrc.nist.gov/Projects/Hardware-Roots-of-Trust">NIST</a> defines Root of trust (RoT) as follows</p>
<blockquote>
<p>Roots of trust are highly reliable hardware, firmware, and software components that perform specific, critical security functions. Because roots of trust are inherently trusted, they must be secure by design.</p>
</blockquote>
<p>Basically, It&rsquo;s hardware implementation of security functions like</p>
<ul>
<li>key management(generation and storage)</li>
<li>cryptographic functions(Block ciphers, Asymmetric key crypto, Hash)</li>
</ul>
<p>The hardware is designed with security threat model in mind. <a href="https://csrc.nist.gov/CSRC/media/Publications/sp/800-164/draft/documents/sp800_164_draft.pdf">NIST Guidelines on Hardware Rooted Security in Mobile Devices</a> states 3 important guidelines for RoT</p>
<ul>
<li>Device Integrity: Device integrity is the absence of corruption in the hardware, firmware and software of a device. A mobile device can provide evidence that it has maintained device integrity if its software, firmware, and hardware configurations can be shown to be in a state that is trusted by a relying party</li>
<li>Isolation: Isolation prevents unintended interaction between applications and Information Contexts on the same device.</li>
<li>Protected Storage: Protected storage preserves the confidentiality and integrity of data on the device while at rest, while in use (in the event an unauthorized application attempts to access an item in protected storage), and upon revocation of access.</li>
</ul>
<p>If you want to find examples of hardware implementation guidelines, a list can be found on <a href="https://docs.opentitan.org/doc/security/implementation_guidelines/hardware/">opentitan</a>. For example, There are guidelines for avoiding <code>side-channel leakage</code></p>
<blockquote>
<p>Recommendation 2: Side-channel leakage considerations
Consider side-channel leakage of any secret information (side channels include timing, power, EM radiation, caches, and micro-architectural state, among others)</p>
<p>Process secret information in at least a 32-bit wide datapath
Use fixed/constant time operations when handling secrets (see <a href="https://csrc.nist.gov/CSRC/media/Publications/sp/800-164/draft/documents/sp800_164_draft.pdf">6</a> and [11])
Don’t branch/perform conditional operations based on secret values</p>
</blockquote>
<p>Naturally, threat model needs to be defined, again <a href="https://docs.opentitan.org/doc/security/threat_model/">opentitan threat model</a></p>
<h1 id="example-1">Example 1</h1>
<p>One interesting guideline from opentitan is Alerts</p>
<blockquote>
<p>Recommendation 5: Alerts
Generate alerts on any detected anomaly (need to define what priority/severity should be assigned)
Where possible, prefer to take a local action (clearing/randomizing state, cease processing) in addition to generating the alert</p>
</blockquote>
<p>This is quick example from opentitan of an alert.</p>
<p>Starting in <code>hw/ip/aes/rtl/aes_ctr_fsm.sv</code></p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-verilog" data-lang="verilog">      CTR_ERROR: <span style="color:#fff;font-weight:bold">begin</span>
        <span style="color:#007f7f">// SEC_CM: CTR.FSM.LOCAL_ESC
</span><span style="color:#007f7f"></span>        <span style="color:#007f7f">// Terminal error state
</span><span style="color:#007f7f"></span>        alert_o = <span style="color:#ff0;font-weight:bold">1</span><span style="color:#ff0;font-weight:bold">&#39;b1</span>;
      <span style="color:#fff;font-weight:bold">end</span>

      <span style="color:#007f7f">// We should never get here. If we do (e.g. via a malicious
</span><span style="color:#007f7f"></span>      <span style="color:#007f7f">// glitch), error out immediately.
</span><span style="color:#007f7f"></span>      <span style="color:#fff;font-weight:bold">default</span>: <span style="color:#fff;font-weight:bold">begin</span>
        aes_ctr_ns = CTR_ERROR;
        alert_o = <span style="color:#ff0;font-weight:bold">1</span><span style="color:#ff0;font-weight:bold">&#39;b1</span>;
      <span style="color:#fff;font-weight:bold">end</span>
</code></pre></div><p>eventually <code>alert_o</code> get connected to <code>ctrl_alert</code> and to <code>alert_fatal_o</code>. And status is set in the CSR <code>alert_fatal_fault</code></p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-verilog" data-lang="verilog">  <span style="color:#007f7f">// Collect fatal alert signals.
</span><span style="color:#007f7f"></span>  <span style="color:#fff;font-weight:bold">assign</span> alert_fatal_o = ctrl_err_storage |
                         ctr_alert        |
                         cipher_alert     |
                         ctrl_alert       |
                         intg_err_alert_i;

  <span style="color:#007f7f">// Make the fatal alert observable via status register.
</span><span style="color:#007f7f"></span>  <span style="color:#fff;font-weight:bold">assign</span> hw2reg.status.alert_fatal_fault.d  = alert_fatal_o;
  <span style="color:#fff;font-weight:bold">assign</span> hw2reg.status.alert_fatal_fault.de = alert_fatal_o;
</code></pre></div><h1 id="example-2">Example 2</h1>
<p>Another example is <code>Recommendation 3: Fault injection countermeasures</code></p>
<blockquote>
<p>Use parity/ECC on memories and data paths (note here that ECC is not true integrity, have to use hash to prevent forgery, see <a href="https://www.rambus.com/blogs/hardware-root-of-trust/">1</a>). For memories, ECC is helpful to protect instruction streams or values that can cause “branching control flows” that redirect execution flow. Parity is potentially helpful if detection of corruption is adequate (though double-glitch fault injection can fool parity, so Hsiao or other detect-2-error codes can be used, even without correction circuitry implemented). When committing to an irrevocable action (e.g. burning into OTP, unlocking part of the device/increasing permissions), ECC is probably more appropriate.</p>
</blockquote>
<p>For example, Flash controller <code>hw/ip/flash_ctrl/rtl/flash_phy_rd.sv</code> is using hamming ECC(Error correcting code)</p>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-verilog" data-lang="verilog">
  prim_secded_hamming_76_68_dec u_dec (
    .data_i(data_i),
    .data_o(data_ecc_chk),
    .syndrome_o(),
    .err_o({ecc_multi_err, ecc_single_err})
  );

  <span style="color:#007f7f">// send out error indication when ecc is enabled
</span><span style="color:#007f7f"></span>  <span style="color:#fff;font-weight:bold">assign</span> data_err = valid_ecc &amp; ecc_multi_err;

  <span style="color:#007f7f">// reliability ECC errors cause both in-band and out-of-band errors
</span><span style="color:#007f7f"></span>  <span style="color:#fff;font-weight:bold">assign</span> relbl_ecc_err_o = data_err;

  <span style="color:#007f7f">// If there is a detected multi-bit error or a single bit error, always return the
</span><span style="color:#007f7f"></span>  <span style="color:#007f7f">// ECC corrected result (even though it is possibly wrong).
</span><span style="color:#007f7f"></span>  <span style="color:#007f7f">// There is no data error of any kind (specifically when multi_err is disabled), just
</span><span style="color:#007f7f"></span>  <span style="color:#007f7f">// return the raw data so that it can be debugged.
</span><span style="color:#007f7f"></span>  <span style="color:#fff;font-weight:bold">assign</span> data_int = data_err | ecc_single_err_o ?
                    data_ecc_chk :
                    data_i[PlainDataWidth-<span style="color:#ff0;font-weight:bold">1</span>:<span style="color:#ff0;font-weight:bold">0</span>];
</code></pre></div>
      </div>
    </article>

    <hr />

    <div class="post-info">
      
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg>

        <span class="tag"><a href="tags/crypto/">crypto</a></span>
        
    </p>

      

      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
          <polyline points="14 2 14 8 20 8"></polyline>
          <line x1="16" y1="13" x2="8" y2="13"></line>
          <line x1="16" y1="17" x2="8" y2="17"></line>
          <polyline points="10 9 9 9 8 9"></polyline>
        </svg>
        643 Words
      </p>

      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar">
          <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
          <line x1="16" y1="2" x2="16" y2="6"></line>
          <line x1="8" y1="2" x2="8" y2="6"></line>
          <line x1="3" y1="10" x2="21" y2="10"></line>
        </svg>
        
          2023-02-17 00:00 &#43;0000
        

         
          
        
      </p>
    </div>

    
      <div class="pagination">
        <div class="pagination__title">
          <span class="pagination__title-h">Read other posts</span>
          <hr />
        </div>

        <div class="pagination__buttons">
          
            <span class="button previous">
              <a href="/posts/2023/02/pcie-physical-layer-8b/10b-encoder/">
                <span class="button__icon">←</span>
                <span class="button__text">PCIe physical layer 8b/10b encoder</span>
              </a>
            </span>
          

          
            <span class="button next">
              <a href="/posts/2023/02/new-computer-who-dis/">
                <span class="button__text">New computer! Who dis?</span>
                <span class="button__icon">→</span>
              </a>
            </span>
          
        </div>
      </div>
    


    

    

  </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2023</span>
            
            <span><a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener">CC BY-NC 4.0</a></span><span><a href="posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by <a href="http://gohugo.io">Hugo</a></span>
            <span>Made with &#10084; by <a href="https://github.com/rhazdon">Djordje Atlialp</a></span>
          </div>
    </div>
</footer>

            
        </div>

        



<script type="text/javascript" src="/bundle.min.2ce64ea6ea44a72b13dd812fc2eb5cca3efe878cce258a47c137c17edf46e0602a05e422b618a5b80b5939c731b7a293351c2f2222a21f6ee27e54a8448dd20e.js" integrity="sha512-LOZOpupEpysT3YEvwutcyj7&#43;h4zOJYpHwTfBft9G4GAqBeQithiluAtZOccxt6KTNRwvIiKiH27iflSoRI3SDg=="></script>



    </body>
</html>
