<!DOCTYPE html>
<html lang="en">

<head>
  <title>
  Crypto - DH key exchange · Techiedeepdive
</title>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="color-scheme" content="light dark">




<meta name="description" content="In most Crypto algorithms, we assumed the keys are already known by Alice and Bob. But we need a way to exchange the keys on securely first

symmertic exchange (not common)
Asymmetric exchange (very popular)

In Asymmetric exchange, Both sides share public keys and the other side uses the public key and private key, to calculate secret key.
Alice  ------ A -----&gt; Bob
      &lt;-------B------

At Alice
Kab = Fun(a, B)

At Bob
Kab = Fun(b, A)

  Diffie–Hellman key exchange (DHKE)
  
    
    Link to heading
  

The problem how make sure is that Bob is Bob?
The good solution using digital signature to sign the public key and Identity. and send certificate which &lt;message, sign(message)&gt;. In this case,  sign_Kpr,a(&lt;Kpub,a  IDa&gt;) where Kpr is Alice&rsquo;s private key.  This way the receiver needs Kpub to verify the certificate first">
<meta name="keywords" content="homepage, blog">



  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="/">
  <meta name="twitter:title" content="Crypto - DH key exchange">
  <meta name="twitter:description" content="In most Crypto algorithms, we assumed the keys are already known by Alice and Bob. But we need a way to exchange the keys on securely first
symmertic exchange (not common) Asymmetric exchange (very popular) In Asymmetric exchange, Both sides share public keys and the other side uses the public key and private key, to calculate secret key.
Alice ------ A -----&gt; Bob &lt;-------B------ At Alice Kab = Fun(a, B) At Bob Kab = Fun(b, A) Diffie–Hellman key exchange (DHKE) Link to heading The problem how make sure is that Bob is Bob? The good solution using digital signature to sign the public key and Identity. and send certificate which &lt;message, sign(message)&gt;. In this case, sign_Kpr,a(&lt;Kpub,a IDa&gt;) where Kpr is Alice’s private key. This way the receiver needs Kpub to verify the certificate first">

<meta property="og:url" content="/posts/2023/03/crypto-dh-key-exchange/">
  <meta property="og:site_name" content="Techiedeepdive">
  <meta property="og:title" content="Crypto - DH key exchange">
  <meta property="og:description" content="In most Crypto algorithms, we assumed the keys are already known by Alice and Bob. But we need a way to exchange the keys on securely first
symmertic exchange (not common) Asymmetric exchange (very popular) In Asymmetric exchange, Both sides share public keys and the other side uses the public key and private key, to calculate secret key.
Alice ------ A -----&gt; Bob &lt;-------B------ At Alice Kab = Fun(a, B) At Bob Kab = Fun(b, A) Diffie–Hellman key exchange (DHKE) Link to heading The problem how make sure is that Bob is Bob? The good solution using digital signature to sign the public key and Identity. and send certificate which &lt;message, sign(message)&gt;. In this case, sign_Kpr,a(&lt;Kpub,a IDa&gt;) where Kpr is Alice’s private key. This way the receiver needs Kpub to verify the certificate first">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-03-11T00:00:00+00:00">
    <meta property="article:modified_time" content="2023-03-11T00:00:00+00:00">
    <meta property="article:tag" content="Cryptography">
    <meta property="og:image" content="/">




<link rel="canonical" href="/posts/2023/03/crypto-dh-key-exchange/">


<link rel="preload" href="/fonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin>


  
  
  <link rel="stylesheet" href="/css/coder.min.aa5ef26fa979d6793724ae2dbd71efa94fd16cb1c5c7db3b6651f21f9892a5fd.css" integrity="sha256-ql7yb6l51nk3JK4tvXHvqU/RbLHFx9s7ZlHyH5iSpf0=" crossorigin="anonymous" media="screen" />






  
    
    
    <link rel="stylesheet" href="/css/coder-dark.min.a00e6364bacbc8266ad1cc81230774a1397198f8cfb7bcba29b7d6fcb54ce57f.css" integrity="sha256-oA5jZLrLyCZq0cyBIwd0oTlxmPjPt7y6KbfW/LVM5X8=" crossorigin="anonymous" media="screen" />
  



 




<link rel="icon" type="image/svg+xml" href="/images/favicon.svg" sizes="any">
<link rel="icon" type="image/png" href="/images/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/images/favicon-16x16.png" sizes="16x16">

<link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#5bbad5">









</head>






<body class="preload-transitions colorscheme-auto">
  
<div class="float-container">
    <a id="dark-mode-toggle" class="colorscheme-toggle">
        <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
    </a>
</div>


  <main class="wrapper">
    <nav class="navigation">
  <section class="container">
    
    <a class="navigation-title" href="/">
      Techiedeepdive
    </a>
    
    
      <input type="checkbox" id="menu-toggle" />
      <label class="menu-button float-right" for="menu-toggle">
        <i class="fa-solid fa-bars fa-fw" aria-hidden="true"></i>
      </label>
      <ul class="navigation-list">
        
          
            <li class="navigation-item">
              <a class="navigation-link " href="/posts">Blog</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/reading-list/">Reading list</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/tags/">Tags</a>
            </li>
          
        
        
      </ul>
    
  </section>
</nav>


    <div class="content">
      
  <section class="container post">
    <article>
      <header>
        <div class="post-title">
          <h1 class="title">
            <a class="title-link" href="/posts/2023/03/crypto-dh-key-exchange/">
              Crypto - DH key exchange
            </a>
          </h1>
        </div>
        <div class="post-meta">
          <div class="date">
            <span class="posted-on">
              <i class="fa-solid fa-calendar" aria-hidden="true"></i>
              <time datetime="2023-03-11T00:00:00Z">
                March 11, 2023
              </time>
            </span>
            <span class="reading-time">
              <i class="fa-solid fa-clock" aria-hidden="true"></i>
              2-minute read
            </span>
          </div>
          
          
          <div class="tags">
  <i class="fa-solid fa-tag" aria-hidden="true"></i>
    <span class="tag">
      <a href="/tags/cryptography/">Cryptography</a>
    </span></div>

        </div>
      </header>

      <div class="post-content">
        
        <p>In most Crypto algorithms, we assumed the keys are already known by Alice and Bob. But we need a way to exchange the keys on securely first</p>
<ul>
<li>symmertic exchange (not common)</li>
<li>Asymmetric exchange (very popular)</li>
</ul>
<p>In Asymmetric exchange, Both sides share public keys and the other side uses the public key and private key, to calculate secret key.</p>
<pre tabindex="0"><code>Alice  ------ A -----&gt; Bob
      &lt;-------B------

At Alice
Kab = Fun(a, B)

At Bob
Kab = Fun(b, A)
</code></pre><h1 id="diffiehellman-key-exchange-dhke">
  Diffie–Hellman key exchange (DHKE)
  <a class="heading-link" href="#diffiehellman-key-exchange-dhke">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h1>
<p>The problem how make sure is that Bob is Bob?
The good solution using digital signature to sign the public key and Identity. and send <code>certificate</code> which &lt;message, sign(message)&gt;. In this case, <code> sign_Kpr,a(&lt;Kpub,a  IDa&gt;)</code> where Kpr is Alice&rsquo;s private key.  This way the receiver needs Kpub to verify the certificate first</p>
<pre tabindex="0"><code>Alice ------- X ------&gt;

X = sign(&lt;Kpub,a  IDa&gt;)
Certa = [
 &lt;Kpub,a  IDa&gt;
 sign_Kpr,a(&lt;Kpub,a  IDa&gt;)
] 
</code></pre><p>Now, the problem is that receiver needs to know Alice&rsquo;s Kpub which the problem we are trying to solve. Here where certificate authority comes in.</p>
<pre tabindex="0"><code>CA generate k_pub_A, k_pr_A

S_a = Sign_Kpr_CA(k_pub_A, ID_A)
Cert_A = &lt;k_pub_A, S_A&gt;

CA sends back Cert_A and k_pr_A
</code></pre><p>For Alice and Bob to communicate, the key establishment should be done first by exchange Cert_A and Cert_B.</p>
<pre tabindex="0"><code>At Alice:
A = K_pub_A
a = K_pr_A

Cert_A = [ (A, ID_A), S_A]
S_A is signature by CA


At Bobe:
B = K_pub_B
b = K_pr_B

Cert_B = [ (B, ID_B), S_B]
S_B is signature by CA


Alice --------- Cert_A ----&gt; Bob
      &lt;--------- Cert_B---- 

At Alice:
verify(Cert_B) and get B.. The verification is using k_pub_CA
Kab = Fun(B, a)
</code></pre><p>Note that verification of <code>Cert_B</code> will use CA public key <code>k_pub_CA</code> which insures that Cert was generated for B (Bob). Obviously, The certificate distribution has to be secure But this has to one-time thing between Alice and CA.</p>

      </div>


      <footer>
        


        
        
        
        
        
        
        
      </footer>
    </article>

    
  </section>

    </div>

    <footer class="footer">
  <section class="container">
    ©
    
    2025
    
    ·
    
      Licensed under <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA-4.0</a>
    ·
    
    Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> & <a href="https://github.com/luizdepra/hugo-coder/" target="_blank" rel="noopener">Coder</a>.
    
  </section>
</footer>

  </main>

  

  
  
  <script src="/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js" integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script>
  

  

  


  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
</body>

</html>
